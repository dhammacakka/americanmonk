<script>
document.addEventListener("DOMContentLoaded", () => {

  const navLinks = document.querySelectorAll("#year-nav a");
  const headings = document.querySelectorAll(".year-heading");

  if (navLinks.length === 0 || headings.length === 0) {
    console.log("ScrollSpy: no headings or nav links found.");
    return;
  }

  // Map: "#year-2021" → <a href="#year-2021">
  const linkMap = {};
  navLinks.forEach(link => {
    linkMap[link.getAttribute("href")] = link;
  });

  // Create observer
  const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      const id = "#" + entry.target.id;

      if (entry.isIntersecting) {
        // Remove all active
        navLinks.forEach(a => a.classList.remove("active"));

        // Activate the one that matches this section
        if (linkMap[id]) {
          linkMap[id].classList.add("active");
        }
      }
    });
  }, {
    root: null,
    rootMargin: "0px 0px -70% 0px",
    threshold: 0.1
  });

  // Observe each year heading
  headings.forEach(h => observer.observe(h));

});
</script>


<footer class="bg-maroon pv4 ph3 ph5-m ph6-l white-80">
  <div class="mw8 center">
    <div class="flex-ns items-center justify-between">
      <!-- Creative Commons notice -->
      <p class="f6 lh-copy mv0" style="font-size:115%;">
        © {{ now.Format "2006" }} Bhante Subhūti <br>
        All content on this site by Bhante Subhūti is licensed under
        <a href="https://creativecommons.org/licenses/by-sa/4.0/"
           class="white-80 underline hover-light-gray"
           target="_blank" rel="noopener">
          CC-Attrib-SA 4.0
        </a>.
      </p>

      <!-- ✅ Modern Ananke social icons -->
    <div class="mt3 mt0-ns">
      {{ partial "social/follow.html" . }}
    </div>

    <!-- Optional extra footer content from config -->
    {{ with .Site.Params.footerContent }}
      <div class="mt3 f6 lh-copy">{{ . | safeHTML }}</div>
    {{ end }}
  </div>
  
</footer>

{{ partial "footnotes-popup.html" . }}